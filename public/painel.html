<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLANA App - Admin Dashboard</title>
    <!-- Bootstrap CSS -->
         <link rel="icon" type="image/x-icon" href="assets/img/69c26357-5c6f-4f2b-8812-6eeb56df9c42.ico">
    <!-- Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
      <!-- Quill JS -->
      <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        :root {
            --warm-sand: #F1EAE3;
            --deep-graphite: #2B2B2B;
            --dark-teal: #4A6A68;
            --coral-ember: #E26D5A;
            --dusty-peach: #D8B7A6;
        }
        
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: var(--warm-sand);
            color: var(--deep-graphite);
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Aeonik', sans-serif;
        }
        
        .sidebar {
            background-color: var(--deep-graphite);
            color: var(--warm-sand);
            height: 100vh;
            position: fixed;
            padding-top: 20px;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link {
            color: var(--warm-sand);
            border-radius: 0;
            margin-bottom: 5px;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            background-color: var(--dark-teal);
            color: white;
        }
        
        .sidebar .nav-link i {
            margin-right: 10px;
        }
        
        main {
            margin-left: 240px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .navbar {
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        
        .card-header {
            background-color: white;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            font-weight: 600;
        }
        
        .btn-primary {
            background-color: var(--coral-ember);
            border-color: var(--coral-ember);
        }
        
        .btn-primary:hover {
            background-color: #c9614f;
            border-color: #c9614f;
        }
        
        .btn-secondary {
            background-color: var(--dusty-peach);
            border-color: var(--dusty-peach);
            color: var(--deep-graphite);
        }
        
        .btn-secondary:hover {
            background-color: #c9a998;
            border-color: #c9a998;
            color: var(--deep-graphite);
        }
        
        .sidebar-logo {
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .sidebar-logo h3 {
            color: var(--warm-sand);
            margin: 0;
            font-weight: 700;
        }
        
        @media (max-width: 767.98px) {
            .sidebar {
                width: 60px;
                overflow: hidden;
            }
            
            .sidebar .nav-link span, .sidebar-logo h3 {
                display: none;
            }
            
            .sidebar .nav-link i {
                margin-right: 0;
                font-size: 1.2rem;
            }
            
            main {
                margin-left: 60px;
            }
        }
        
        .page-title {
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--deep-graphite);
            border-bottom: 3px solid var(--dark-teal);
            display: inline-block;
            padding-bottom: 5px;
        }
        
        .form-label {
            font-weight: 500;
        }
        
        .thumbnail-preview {
            width: 120px;
            height: 120px;
            border-radius: 8px;
            object-fit: cover;
            border: 1px solid #dee2e6;
        }
        
        .table-action-buttons .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar d-flex flex-column flex-shrink-0 p-3 col-md-3 col-lg-2">
        <div class="sidebar-logo">
            <h3>PLANA</h3>
        </div>
        <hr>
        <ul class="nav nav-pills flex-column mb-auto">
            <li class="nav-item">
                <a href="#" class="nav-link active" data-bs-toggle="tab" data-bs-target="#dashboard">
                    <i class="bi bi-house-door"></i> <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#recipes">
                    <i class="bi bi-egg-fried"></i> <span>Recipes</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#challenges">
                    <i class="bi bi-trophy"></i> <span>Challenges</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#articles">
                    <i class="bi bi-newspaper"></i> <span>Articles</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#users">
                    <i class="bi bi-people"></i> <span>Users</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#glucose-walk">
                  <i class="bi bi-activity"></i> <span>Glucose Walk</span>
                </a>
              </li>
            <li class="nav-item">
            <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#light-activation">
                <i class="bi bi-people"></i> <span>Light Activation</span>
            </a>
        </li>
<!-- ADD THIS INSIDE THE NAVIGATION MENU (sidebar) -->
<li class="nav-item">
  <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#learn-more">
      <i class="bi bi-journal-text"></i> <span>Learn More</span>
  </a>
</li>
<li class="nav-item">
  <a href="#" class="nav-link" data-bs-toggle="tab" data-bs-target="#science">
      <i class="bi bi-flask"></i> <span>Science</span>
  </a>
</li>

        </ul>
        <hr>
        <div class="dropdown">
            <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
                <img src="/api/placeholder/40/40" width="32" height="32" class="rounded-circle me-2" alt="Admin">
                <span>Admin</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdownUser1">
                <li><a class="dropdown-item" href="#">Profile</a></li>
                <li><a class="dropdown-item" href="#">Settings</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="#">Sign out</a></li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <main class="content">
        <div class="tab-content">
            <!-- Dashboard Tab -->
            <div class="tab-pane fade show active" id="dashboard">
                <div class="container-fluid">
                    <h1 class="page-title">Dashboard</h1>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Total Recipes</h5>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="display-4">42</div>
                                        <i class="bi bi-egg-fried fs-1 text-primary"></i>
                                    </div>
                                    <p class="text-muted">Last added: 05/03/2025</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Total Challenges</h5>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="display-4">15</div>
                                        <i class="bi bi-trophy fs-1 text-warning"></i>
                                    </div>
                                    <p class="text-muted">Last added: 05/01/2025</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Total Articles</h5>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="display-4">28</div>
                                        <i class="bi bi-newspaper fs-1 text-info"></i>
                                    </div>
                                    <p class="text-muted">Last added: 05/04/2025</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Recent Activities</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>Activity</th>
                                                    <th>User</th>
                                                    <th>Type</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>05/05/2025</td>
                                                    <td>Added new recipe: "Berry Smoothie Bowl"</td>
                                                    <td>admin@plana.com</td>
                                                    <td><span class="badge bg-primary">Recipe</span></td>
                                                </tr>
                                                <tr>
                                                    <td>05/04/2025</td>
                                                    <td>Added new article: "Glucose Balance - Quick Tips"</td>
                                                    <td>admin@plana.com</td>
                                                    <td><span class="badge bg-info">Article</span></td>
                                                </tr>
                                                <tr>
                                                    <td>05/01/2025</td>
                                                    <td>Added new challenge: "7 Days Without Refined Sugar"</td>
                                                    <td>admin@plana.com</td>
                                                    <td><span class="badge bg-warning text-dark">Challenge</span></td>
                                                </tr>
                                                <tr>
                                                    <td>04/30/2025</td>
                                                    <td>Updated recipe: "Quinoa Salad"</td>
                                                    <td>admin@plana.com</td>
                                                    <td><span class="badge bg-primary">Recipe</span></td>
                                                </tr>
                                                <tr>
                                                    <td>04/28/2025</td>
                                                    <td>Added new article: "Anti-inflammatory Foods"</td>
                                                    <td>admin@plana.com</td>
                                                    <td><span class="badge bg-info">Article</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            
            <!-- Recipes Tab -->
            <div class="tab-pane fade" id="recipes">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h1 class="page-title">Manage Recipes</h1>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addRecipeModal">
                            <i class="bi bi-plus-circle"></i> New Recipe
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Recipe List</h5>
                            <div class="input-group" style="max-width: 300px;">
                                <input type="text" class="form-control" placeholder="Search recipes...">
                                <button class="btn btn-outline-secondary" type="button">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive" id="recipes">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th width="80">Image</th>
                                            <th>Title</th>
                                            <th>Category</th>
                                            <th>Meal Type</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                      
                                    </tbody>
                                </table>
                            </div>
                          
                        </div>
                    </div>
                </div>
                
                
                  
                <!-- Add Recipe Modal -->
<div class="modal fade" id="addRecipeModal" tabindex="-1" aria-labelledby="addRecipeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addRecipeModalLabel">Add New Recipe</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="addRecipeForm" enctype="multipart/form-data">
            <div class="row mb-3">
              <div class="col-md-8">
                <div class="mb-3">
                  <label for="recipeTitle" class="form-label">Recipe Title</label>
                  <input type="text" class="form-control" id="recipeTitle" name="title" required>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="recipeCategory" class="form-label">Category</label>
                      <select class="form-select" id="recipeCategory" name="category" required>
                        <option value="">Select</option>
                        <option>Breakfast</option>
                        <option>Lunch</option>
                        <option>Dinner</option>
                        <option>Snack</option>
                        <option>Beverages</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="recipeMealType" class="form-label">Meal Type</label>
                      <select class="form-select" id="recipeMealType" name="meal_type" required>
                        <option value="">Select</option>
                        <option>Breakfast</option>
                        <option>Lunch</option>
                        <option>Dinner</option>
                        <option>Snack</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-3 text-center">
                  <label class="form-label">Recipe Image</label>
                  <img id="imagePreview" src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Recipe Preview">
                  <input type="file" class="form-control" id="recipeImage" name="image" accept="image/*">
                </div>
              </div>
            </div>
  
          <!-- Ingredients -->
<div class="mb-3">
  <label class="form-label">Ingredients</label>
  <div class="quill-editor" data-quill="recipe-add-ingredients" style="height: 150px;"></div>
  <input type="hidden" name="ingredients" data-quill-target="recipe-add-ingredients">
  <small class="text-muted">One ingredient per line</small>
</div>

<!-- Instructions -->
<div class="mb-3">
  <label class="form-label">Instructions</label>
  <div class="quill-editor" data-quill="recipe-add-instructions" style="height: 200px;"></div>
  <input type="hidden" name="instructions" data-quill-target="recipe-add-instructions">
  <small class="text-muted">Numbered, step by step</small>
</div>
  
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="recipePrep" class="form-label">Prep Time (min)</label>
                  <input type="number" class="form-control" id="recipePrep" name="prep_time" min="1">
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="recipeCalories" class="form-label">Calories</label>
                  <input type="number" class="form-control" id="recipeCalories" name="calories" min="0">
                </div>
              </div>
            </div>
  
            <div class="form-check form-switch mb-3">
              <input class="form-check-input" type="checkbox" id="recipePublish" name="published" checked>
              <label class="form-check-label" for="recipePublish">Publish immediately</label>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Save Recipe</button>
        </div>
      </div>
    </div>
  </div>
            </div>
  
  <div class="tab-pane fade" id="glucose-walk">
    <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="page-title">Manage Glucose Walk</h1>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addGlucoseModal">
          <i class="bi bi-plus-circle"></i> New Entry
        </button>
      </div>
  
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Entries</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Title</th>
                  <th>Text</th>
                  <th>References</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="glucoseEntries">
                <!-- JS will populate here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
<!-- Add Glucose Modal -->
<div class="modal fade" id="addGlucoseModal" tabindex="-1" aria-labelledby="addGlucoseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addGlucoseModalLabel">New Glucose Walk Entry</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="glucoseForm">
            <div class="mb-3">
              <label for="glucoseTitle" class="form-label">Title</label>
              <input type="text" class="form-control" id="glucoseTitle" name="title" required>
            </div>
            <!-- Qualquer modal/formulário -->
              <div class="mb-3">
                <label class="editGlucoseText">Text</label>
                <div class="quill-editor" data-quill="glucose-add-text" style="height: 200px;"></div>
                <input type="hidden" name="text" data-quill-target="glucose-add-text">
            </div>
            <div class="mb-3">
              <label for="glucoseRefs" class="form-label">References</label>
              <textarea class="form-control" id="glucoseRefs" name="references_text" rows="3"></textarea>
            </div>
            <div class="mb-3">
              <label for="glucoseImage" class="form-label">Image</label>
              <input type="file" class="form-control" id="glucoseImage" name="image" accept="image/*">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="submitGlucoseEntry()">Save Entry</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Edit Glucose Modal -->
<div class="modal fade" id="editGlucoseModal" tabindex="-1" aria-labelledby="editGlucoseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editGlucoseModalLabel">Edit Glucose Walk Entry</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editGlucoseForm">
            <input type="hidden" id="editGlucoseId">
  
            <div class="mb-3">
              <label for="editGlucoseTitle" class="form-label">Title</label>
              <input type="text" class="form-control" id="editGlucoseTitle" name="title" required>
            </div>
  
            <!-- Qualquer modal/formulário -->
              <div class="mb-3">
                <label class="editGlucoseTex">Text</label>
                <div class="quill-editor" data-quill="glucose-edit-text" style="height: 200px;"></div>
                <input type="hidden" name="text" data-quill-target="glucose-edit-text">
            </div>
  
            <div class="mb-3">
              <label for="editGlucoseRefs" class="form-label">References</label>
              <textarea class="form-control" id="editGlucoseRefs" name="references_text" rows="3"></textarea>
            </div>
  
            <div class="mb-3 text-center">
              <label class="form-label">Image</label>
              <img id="editGlucosePreview" src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Preview">
              <input type="file" class="form-control" id="editGlucoseImage" name="image" accept="image/*">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="submitGlucoseEdit()">Save Changes</button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
   document.querySelector('#addRecipeModal .btn-primary').addEventListener('click', async () => {
  const form = document.getElementById('addRecipeForm');
  const formData = new FormData();

  const quillIngredients = quillInstances["recipe-add-ingredients"];
  const quillInstructions = quillInstances["recipe-add-instructions"];

  if (!quillIngredients || !quillInstructions) {
    alert("Um ou mais editores Quill não foram encontrados.");
    return;
  }

  formData.append('title', document.getElementById('recipeTitle').value);
  formData.append('category', document.getElementById('recipeCategory').value);
  formData.append('meal_type', document.getElementById('recipeMealType').value);
  formData.append('ingredients', quillIngredients.root.innerHTML);
  formData.append('instructions', quillInstructions.root.innerHTML);
  formData.append('prep_time', document.getElementById('recipePrep').value);
  formData.append('calories', document.getElementById('recipeCalories').value);
  formData.append('published', document.getElementById('recipePublish').checked);

  const imageInput = document.getElementById('recipeImage');
  if (imageInput.files.length > 0) {
    formData.append('image', imageInput.files[0]);
  }

  try {
    const response = await fetch('/recipes', {
      method: 'POST',
      body: formData
    });

    const result = await response.json();
    if (response.ok) {
      alert('Receita criada com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('addRecipeModal')).hide();
      form.reset();
      quillIngredients.setContents([]);
      quillInstructions.setContents([]);
      location.reload();
    } else {
      alert('Erro ao salvar receita: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
});

    </script>
    <script>
        document.getElementById('recipeImage').addEventListener('change', function (event) {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              document.getElementById('imagePreview').src = e.target.result;
            };
            reader.readAsDataURL(file);
          }
        });
        </script>
    
            
            <!-- Challenges Tab -->
            <div class="tab-pane fade" id="challenges">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h1 class="page-title">Manage Challenges</h1>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addChallengeModal">
                            <i class="bi bi-plus-circle"></i> New Challenge
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Challenge List</h5>
                            <div class="input-group" style="max-width: 300px;">
                                <input type="text" class="form-control" placeholder="Search challenges...">
                                <button class="btn btn-outline-secondary" type="button">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th width="80">Image</th>
                                            <th>Title</th>
                                            <th>Duration</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Challenge"></td>
                                            <td>7 Days Without Refined Sugar</td>
                                            <td>7 days</td>
                                            <td>05/01/2025</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Challenge"></td>
                                            <td>Glucose Walk After Every Meal</td>
                                            <td>14 days</td>
                                            <td>04/20/2025</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Challenge"></td>
                                            <td>Mindful Hydration</td>
                                            <td>7 days</td>
                                            <td>04/15/2025</td>
                                            <td><span class="badge bg-secondary">Completed</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <nav aria-label="Page navigation" class="mt-3">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1">Previous</a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">Next</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                
                <!-- Add Challenge Modal -->
                <div class="modal fade" id="addChallengeModal" tabindex="-1" aria-labelledby="addChallengeModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="addChallengeModalLabel">Add New Challenge</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="row mb-3">
                                        <div class="col-md-8">
                                            <div class="mb-3">
                                                <label for="challengeTitle" class="form-label">Challenge Title</label>
                                                <input type="text" class="form-control" id="challengeTitle" placeholder="E.g., 7 Days Without Refined Sugar">
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="challengeDuration" class="form-label">Duration (days)</label>
                                                        <input type="number" class="form-control" id="challengeDuration" min="1" value="7">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="challengeCategory" class="form-label">Category</label>
                                                        <select class="form-select" id="challengeCategory">
                                                            <option value="">Select</option>
                                                            <option>Nutrition</option>
                                                            <option>Movement</option>
                                                            <option>Mindfulness</option>
                                                            <option>Habits</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="mb-3 text-center">
                                                <label class="form-label">Challenge Image</label>
                                                <div class="mt-2">
                                                    <img src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Challenge Preview">
                                                    <div>
                                                        <button type="button" class="btn btn-sm btn-secondary">Choose Image</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                   <!-- Qualquer modal/formulário -->
                                      <div class="mb-3">
                                        <label class="challengeDescription">Description</label>
                                        <div class="quill-editor" data-quill="challenge-add-description" style="height: 200px;"></div>
                                        <input type="hidden" name="description" data-quill-target="challenge-add-description">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="challengeRules" class="form-label">Rules & Instructions</label>
                                        <textarea class="form-control" id="challengeRules" rows="5" placeholder="1. Avoid all food and drinks with added sugar&#10;2. Read labels carefully&#10;3. Log your progress daily"></textarea>
                                        <small class="text-muted">Numbered list of instructions</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="challengeBenefits" class="form-label">Benefits</label>
                                        <textarea class="form-control" id="challengeBenefits" rows="3" placeholder="• Reduced cravings&#10;• More stable energy levels&#10;• Better sleep quality"></textarea>
                                        <small class="text-muted">Bullet points of benefits</small>
                                    </div>
                                    
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="challengePublish" checked>
                                        <label class="form-check-label" for="challengePublish">Publish immediately</label>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary">Save Challenge</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ADD THIS INSIDE THE MAIN TAB CONTENT AREA -->
<div class="tab-pane fade" id="learn-more">
  <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mb-4">
          <h1 class="page-title">Manage Learn More</h1>
          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addLearnMoreModal">
              <i class="bi bi-plus-circle"></i> New Entry
          </button>
      </div>
      <div class="card">
          <div class="card-header">
              <h5 class="mb-0">Entries</h5>
          </div>
          <div class="card-body">
              <div class="table-responsive">
                  <table class="table table-hover">
                      <thead>
                          <tr>
                              <th>Image</th>
                              <th>Title</th>
                              <th>Description</th>
                              <th>References</th>
                              <th>Actions</th>
                          </tr>
                      </thead>
                      <tbody id="learnMoreEntries">
                          <!-- Filled via JS -->
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
  </div>
</div>

<!-- Science Tab -->
<div class="tab-pane fade" id="science">
  <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mb-4">
          <h1 class="page-title">Manage Science</h1>
          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addScienceModal">
              <i class="bi bi-plus-circle"></i> New Entry
          </button>
      </div>
      <div class="card">
          <div class="card-header">
              <h5 class="mb-0">Entries</h5>
          </div>
          <div class="card-body">
              <div class="table-responsive">
                  <table class="table table-hover">
                      <thead>
                          <tr>
                              <th>Image</th>
                              <th>Title</th>
                              <th>Description</th>
                              <th>References</th>
                              <th>Actions</th>
                          </tr>
                      </thead>
                      <tbody id="scienceEntries">
                          <!-- Filled via JS -->
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
  </div>
</div>

            <!-- Articles Tab -->
            <div class="tab-pane fade" id="articles">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h1 class="page-title">Manage Articles</h1>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addArticleModal">
                            <i class="bi bi-plus-circle"></i> New Article
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Article List</h5>
                            <div class="input-group" style="max-width: 300px;">
                                <input type="text" class="form-control" placeholder="Search articles...">
                                <button class="btn btn-outline-secondary" type="button">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th width="80">Image</th>
                                            <th>Title</th>
                                            <th>Category</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Article"></td>
                                            <td>Glucose Balance - Quick Tips</td>
                                            <td>Nutrition</td>
                                            <td>05/04/2025</td>
                                            <td><span class="badge bg-success">Published</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Article"></td>
                                            <td>Anti-inflammatory Foods</td>
                                            <td>Nutrition</td>
                                            <td>04/28/2025</td>
                                            <td><span class="badge bg-success">Published</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Article"></td>
                                            <td>Benefits of Post-Meal Walking</td>
                                            <td>Movement</td>
                                            <td>04/22/2025</td>
                                            <td><span class="badge bg-success">Published</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Article"></td>
                                            <td>Understanding Glucose Spikes</td>
                                            <td>Science</td>
                                            <td>04/15/2025</td>
                                            <td><span class="badge bg-success">Published</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><img src="/api/placeholder/60/60" class="rounded" width="60" height="60" alt="Article"></td>
                                            <td>Sleep Quality and Metabolism</td>
                                            <td>Lifestyle</td>
                                            <td>04/10/2025</td>
                                            <td><span class="badge bg-success">Published</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <nav aria-label="Page navigation" class="mt-3">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1">Previous</a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">Next</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                
                <!-- Add Article Modal -->
                <div class="modal fade" id="addArticleModal" tabindex="-1" aria-labelledby="addArticleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="addArticleModalLabel">Add New Article</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="row mb-3">
                                        <div class="col-md-8">
                                            <div class="mb-3">
                                                <label for="articleTitle" class="form-label">Article Title</label>
                                                <input type="text" class="form-control" id="articleTitle" placeholder="E.g., Understanding Glucose Balance">
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="articleCategory" class="form-label">Category</label>
                                                        <select class="form-select" id="articleCategory">
                                                            <option value="">Select</option>
                                                            <option>Nutrition</option>
                                                            <option>Movement</option>
                                                            <option>Science</option>
                                                            <option>Lifestyle</option>
                                                            <option>Success Stories</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="articleTags" class="form-label">Tags</label>
                                                        <input type="text" class="form-control" id="articleTags" placeholder="E.g., glucose, insulin, energy">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="mb-3 text-center">
                                                <label class="form-label">Featured Image</label>
                                                <div class="mt-2">
                                                    <img src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Article Preview">
                                                    <div>
                                                        <button type="button" class="btn btn-sm btn-secondary">Choose Image</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="articleSummary" class="form-label">Summary</label>
                                        <textarea class="form-control" id="articleSummary" rows="2" placeholder="Brief summary of the article (appears in previews)"></textarea>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="articleContent" class="form-label">Article Content</label>
                                        <textarea class="form-control" id="articleContent" rows="10" placeholder="Full article content here..."></textarea>
                                        <small class="text-muted">You can use markdown for formatting</small>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="articleSources" class="form-label">Sources & References</label>
                                        <textarea class="form-control" id="articleSources" rows="3" placeholder="1. Author Name (Year). Article title. Journal name, volume(issue), pages.&#10;2. Website Name (Year). Article title. Retrieved from: URL"></textarea>
                                    </div>
                                    
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="articlePublish" checked>
                                        <label class="form-check-label" for="articlePublish">Publish immediately</label>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary">Save Article</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Users Tab -->
            <div class="tab-pane fade" id="users">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h1 class="page-title">Manage Users</h1>
                        <button class="btn btn-primary">
                            <i class="bi bi-download"></i> Export Users
                        </button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">User List</h5>
                            <div class="input-group" style="max-width: 300px;">
                                <input type="text" class="form-control" placeholder="Search users...">
                                <button class="btn btn-outline-secondary" type="button">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>User ID</th>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Registration</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>#USR001</td>
                                            <td>John Smith</td>
                                            <td>john.smith@example.com</td>
                                            <td>05/04/2025</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#USR002</td>
                                            <td>Maria Garcia</td>
                                            <td>maria.garcia@example.com</td>
                                            <td>04/30/2025</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#USR003</td>
                                            <td>Carlos Santos</td>
                                            <td>carlos.santos@example.com</td>
                                            <td>04/28/2025</td>
                                            <td><span class="badge bg-warning text-dark">Pending</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#USR004</td>
                                            <td>Ana Costa</td>
                                            <td>ana.costa@example.com</td>
                                            <td>04/27/2025</td>
                                            <td><span class="badge bg-danger">Inactive</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#USR005</td>
                                            <td>Paul Mendes</td>
                                            <td>paul.mendes@example.com</td>
                                            <td>04/25/2025</td>
                                            <td><span class="badge bg-success">Active</span></td>
                                            <td>
                                                <div class="btn-group table-action-buttons">
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                    <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                                    <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <nav aria-label="Page navigation" class="mt-3">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1">Previous</a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">Next</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Glucose Walk Tab -->
            <div class="tab-pane fade" id="science">
              <div class="container-fluid">
                  <div class="d-flex justify-content-between align-items-center mb-4">
                      <h1 class="page-title">Manage Science</h1>
                      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addScienceModal">
                          <i class="bi bi-plus-circle"></i> New Entry
                      </button>
                  </div>
                  <div class="card">
                      <div class="card-header">
                          <h5 class="mb-0">Entries</h5>
                      </div>
                      <div class="card-body">
                          <div class="table-responsive">
                              <table class="table table-hover">
                                  <thead>
                                      <tr>
                                          <th>Image</th>
                                          <th>Title</th>
                                          <th>Description</th>
                                          <th>References</th>
                                          <th>Actions</th>
                                      </tr>
                                  </thead>
                                  <tbody id="scienceEntries">
                                      <!-- Filled via JS -->
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          
    <!-- Light Activation Tab -->
<div class="tab-pane fade" id="light-activation">
    <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="page-title">Manage Light Activation</h1>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addLightActivationModal">
          <i class="bi bi-plus-circle"></i> New Entry
        </button>
      </div>
  
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Entries</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Title</th>
                  <th>Goal</th>
                  <th>Duration</th>
                  <th>Best Time</th>
                  <th>Steps</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="lightActivationEntries">
                <!-- Populated via JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Add Light Activation Modal -->
  <div class="modal fade" id="addLightActivationModal" tabindex="-1" aria-labelledby="addLightActivationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addLightActivationModalLabel">New Light Activation Entry</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="lightActivationForm">
            <div class="mb-3">
              <label for="lightTitle" class="form-label">Title</label>
              <input type="text" class="form-control" id="lightTitle" name="title" required>
            </div>
            <div class="mb-3">
              <label for="lightGoal" class="form-label">Goal</label>
              <input type="text" class="form-control" id="lightGoal" name="goal">
            </div>
            <div class="mb-3">
              <label for="lightDuration" class="form-label">Duration</label>
              <input type="text" class="form-control" id="lightDuration" name="duration">
            </div>
            <div class="mb-3">
              <label for="lightBestTime" class="form-label">Best Time</label>
              <input type="text" class="form-control" id="lightBestTime" name="best_time">
            </div>
           <div class="mb-3">
            <label class="form-label">Steps</label>
            <div class="quill-editor" data-quill="light-add-steps" style="height: 200px;"></div>
            <input type="hidden" name="steps" data-quill-target="light-add-steps">
          </div>
            <div class="mb-3">
              <label for="lightImage" class="form-label">Image</label>
              <input type="file" class="form-control" id="lightImage" name="image" accept="image/*">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="submitLightActivationEntry()">Save Entry</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Edit Light Activation Modal -->
  <div class="modal fade" id="editLightActivationModal" tabindex="-1" aria-labelledby="editLightActivationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editLightActivationModalLabel">Edit Light Activation Entry</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editLightActivationForm">
            <input type="hidden" id="editLightId">
            <div class="mb-3">
              <label for="editLightTitle" class="form-label">Title</label>
              <input type="text" class="form-control" id="editLightTitle" name="title" required>
            </div>
            <div class="mb-3">
              <label for="editLightGoal" class="form-label">Goal</label>
              <input type="text" class="form-control" id="editLightGoal" name="goal">
            </div>
            <div class="mb-3">
              <label for="editLightDuration" class="form-label">Duration</label>
              <input type="text" class="form-control" id="editLightDuration" name="duration">
            </div>
            <div class="mb-3">
              <label for="editLightBestTime" class="form-label">Best Time</label>
              <input type="text" class="form-control" id="editLightBestTime" name="best_time">
            </div>
              <!-- Qualquer modal/formulário -->
              <div class="mb-3">
            <label class="form-label">Steps</label>
            <div class="quill-editor" data-quill="light-edit-steps" style="height: 200px;"></div>
            <input type="hidden" name="steps" data-quill-target="light-edit-steps">
          </div>
            <div class="mb-3 text-center">
              <label class="form-label">Image</label>
              <img id="editLightPreview" src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Preview">
              <input type="file" class="form-control" id="editLightImage" name="image" accept="image/*">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="submitLightActivationEdit()">Save Changes</button>
        </div>
      </div>
    </div>
  </div>
  
        </div>
        
    </main>
    <div class="modal fade" id="editRecipeModal" tabindex="-1" aria-labelledby="editRecipeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="editRecipeModalLabel">Edit Recipe</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

              <form id="editRecipeForm">
                <div class="row">

              
                  <div class="col-md-8">
                <input type="hidden" id="editRecipeId">
                <div class="mb-3">
                  <label class="form-label">Title</label>
                  <input type="text" class="form-control" id="editRecipeTitle" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Category</label>
                  <input type="text" class="form-control" id="editRecipeCategory" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Meal Type</label>
                  <input type="text" class="form-control" id="editRecipeMealType" required>
                </div>
               <!-- Ingredients -->
<div class="mb-3">
  <label class="form-label">Ingredients</label>
  <div class="quill-editor" data-quill="recipe-edit-ingredients" style="height: 150px;"></div>
  <input type="hidden" name="ingredients" data-quill-target="recipe-edit-ingredients">
</div>

<!-- Instructions -->
<div class="mb-3">
  <label class="form-label">Instructions</label>
  <div class="quill-editor" data-quill="recipe-edit-instructions" style="height: 200px;"></div>
  <input type="hidden" name="instructions" data-quill-target="recipe-edit-instructions">
</div>
                  </div>
                  <div class="col-md-4">
                    <div class="mb-3 text-center">
                      <label class="form-label">Recipe Image</label>
                      <img id="editImagePreview" src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Recipe Preview">
                      <input type="file" class="form-control" id="editRecipeImage" accept="image/*">
                    </div>
                  </div>
        </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary" onclick="submitEdit()">Save Changes</button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal fade" id="addLearnMoreModal" tabindex="-1" aria-labelledby="addLearnMoreModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="addLearnMoreModalLabel">Add New Learn More Entry</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="learnMoreForm">
                <div class="mb-3">
                  <label for="learnTitle" class="form-label">Title</label>
                  <input type="text" class="form-control" id="learnTitle" name="title" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Description</label>
                  <div class="quill-editor" data-quill="learn-add-description" style="height: 200px;"></div>
                  <input type="hidden" name="description" data-quill-target="learn-add-description">
                </div>
                <div class="mb-3">
                  <label for="learnReferences" class="form-label">References</label>
                  <textarea class="form-control" id="learnReferences" name="references_text" rows="3"></textarea>
                </div>
                <div class="mb-3">
                  <label for="learnImage" class="form-label">Image</label>
                  <input type="file" class="form-control" id="learnImage" name="image" accept="image/*">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary" onclick="submitLearnMore()">Save Entry</button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal fade" id="addScienceModal" tabindex="-1" aria-labelledby="addScienceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="addScienceModalLabel">Add New Science Entry</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="scienceForm">
                <div class="mb-3">
                  <label for="scienceTitle" class="form-label">Title</label>
                  <input type="text" class="form-control" id="scienceTitle" name="title" required>
                </div>
                <div class="mb-3">
                <label class="form-label">Description</label>
                <div class="quill-editor" data-quill="science-add-description" style="height: 200px;"></div>
                <input type="hidden" name="description" data-quill-target="science-add-description">
              </div>

                <div class="mb-3">
                  <label for="scienceReferences" class="form-label">References</label>
                  <textarea class="form-control" id="scienceReferences" name="references_text" rows="3"></textarea>
                </div>
                <div class="mb-3">
                  <label for="scienceImage" class="form-label">Image</label>
                  <input type="file" class="form-control" id="scienceImage" name="image" accept="image/*">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary" onclick="submitScienceEntry()">Save Entry</button>
            </div>
          </div>
        </div>
      </div>
      <!-- Edit Science Modal -->
<div class="modal fade" id="editScienceModal" tabindex="-1" aria-labelledby="editScienceModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editScienceModalLabel">Edit Science Entry</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editScienceForm">
          <input type="hidden" id="editScienceId">
          <div class="mb-3">
            <label for="editScienceTitle" class="form-label">Title</label>
            <input type="text" class="form-control" id="editScienceTitle" name="title" required>
          </div>
     
                <div class="mb-3">
                  <label class="editScienceDescription">Description</label>
                  <div class="quill-editor" id="editScienceDescription" data-quill="editScience-description" style="height: 200px;"></div>
                  <input type="hidden"   name="description" data-quill-target="editScience-description">
              </div>
          <div class="mb-3">
            <label for="editScienceReferences" class="form-label">References</label>
            <textarea class="form-control" id="editScienceReferences" name="references_text" rows="3"></textarea>
          </div>
          <div class="mb-3 text-center">
            <label class="form-label">Image</label>
            <img id="editSciencePreview" src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Preview">
            <input type="file" class="form-control" id="editScienceImage" name="image" accept="image/*">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="submitScienceEdit()">Save Changes</button>
      </div>
    </div>
  </div>
</div>
<!-- Edit Learn More Modal -->
<div class="modal fade" id="editLearnMoreModal" tabindex="-1" aria-labelledby="editLearnMoreModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editLearnMoreModalLabel">Edit Learn More Entry</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editLearnMoreForm">
          <input type="hidden" id="editLearnId">
          <div class="mb-3">
            <label for="editLearnTitle" class="form-label">Title</label>
            <input type="text" class="form-control" id="editLearnTitle" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Description</label>
            <div class="quill-editor" data-quill="editLearn-description" style="height: 200px;"></div>
            <input type="hidden" name="description" data-quill-target="editLearn-description">
          </div>
          <div class="mb-3">
            <label for="editLearnReferences" class="form-label">References</label>
            <textarea class="form-control" id="editLearnReferences" rows="3"></textarea>
          </div>
          <div class="mb-3 text-center">
            <label class="form-label">Image</label>
            <img id="editLearnPreview" src="/api/placeholder/120/120" class="thumbnail-preview mb-2" alt="Preview">
            <input type="file" class="form-control" id="editLearnImage" accept="image/*">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" onclick="submitLearnMoreEdit()">Save Changes</button>
      </div>
    </div>
  </div>
</div>

      

    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script>
        // Tab navigation
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.sidebar .nav-link');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Initialize tooltips
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
        
        // Form validation for modals
        const validateForm = (formId) => {
            const form = document.getElementById(formId);
            if (!form) return false;
            
            let isValid = true;
            const requiredFields = form.querySelectorAll('[required]');
            
            requiredFields.forEach(field => {
                if (!field.value) {
                    field.classList.add('is-invalid');
                    isValid = false;
                } else {
                    field.classList.remove('is-invalid');
                }
            });
            
            return isValid;
        };
        
        // Handle form submissions
        const saveButtons = document.querySelectorAll('.modal-footer .btn-primary');
        saveButtons.forEach(button => {
            button.addEventListener('click', function() {
                const modal = this.closest('.modal');
                const form = modal.querySelector('form');
                
                if (form && validateForm(form.id)) {
                    // Here you would normally submit the form data via AJAX
                    // For demonstration, we'll just close the modal and show a success toast
                    const modalInstance = bootstrap.Modal.getInstance(modal);
                    modalInstance.hide();
                    
                    // Show success message (in a real application)
                    alert('Item saved successfully!');
                }
            });
        });
        
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
          await loadRecipes();
          await loadLightActivationEntries();
        });
        
        async function loadRecipes() {
          try {
            const res = await fetch('/recipes');
            const data = await res.json();
        
            if (!Array.isArray(data)) {
              console.error('Resposta inválida:', data);
              return;
            }
        
            const tbody = document.querySelector('#recipes table tbody');
            tbody.innerHTML = ''; // limpa receitas anteriores
        
            data.forEach(recipe => {
              const row = document.createElement('tr');
        
              row.innerHTML = `
                <td><img src="${recipe.image_url || '/api/placeholder/60/60'}" class="rounded" width="60" height="60" alt="Recipe"></td>
                <td>${recipe.title}</td>
                <td>${recipe.category}</td>
                <td>${recipe.meal_type}</td>
                <td>
                  <div class="btn-group table-action-buttons">
                    <button class="btn btn-sm btn-outline-secondary" onclick="editRecipe('${recipe.id}')"><i class="bi bi-pencil"></i></button>
                    <button class="btn btn-sm btn-outline-primary" onclick="viewRecipe('${recipe.id}')"><i class="bi bi-eye"></i></button>
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteRecipe('${recipe.id}')"><i class="bi bi-trash"></i></button>
                  </div>
                </td>
              `;
        
              tbody.appendChild(row);
            });
        
          } catch (err) {
            console.error('Erro ao carregar receitas:', err);
          }
        }
        
        function editRecipe(id) {
          // TO DO: abrir modal com os dados da receita (você pode fazer um fetch(`/recipes/${id}`) aqui)
          alert('Abrir modal de edição para receita ID ' + id);
        }
        
        function viewRecipe(id) {
          // TO DO: abrir modal de visualização (ou navegar para outra tela)
          alert('Visualizar receita ID ' + id);
        }
        
        async function deleteRecipe(id) {
          if (!confirm('Tem certeza que deseja excluir esta receita?')) return;
        
          try {
            const res = await fetch(`/recipes/${id}`, {
              method: 'DELETE'
            });
        
            const result = await res.json();
            if (res.ok) {
              alert('Receita excluída com sucesso');
              await loadRecipes();
            } else {
              alert('Erro ao excluir: ' + (result.message || 'Erro desconhecido'));
            }
          } catch (err) {
            alert('Erro inesperado: ' + err.message);
          }
        }
        </script>
        <script>
 async function editRecipe(id) {
  try {
    const res = await fetch(`/recipes/${id}`, { credentials: 'include' });
    const recipe = await res.json();

    document.getElementById('editRecipeId').value = recipe.id;
    document.getElementById('editRecipeTitle').value = recipe.title;
    document.getElementById('editRecipeCategory').value = recipe.category;
    document.getElementById('editRecipeMealType').value = recipe.meal_type;

    document.getElementById('editImagePreview').src = recipe.image_url || '/api/placeholder/120/120';

    const quillIngredients = quillInstances["recipe-edit-ingredients"];
    const quillInstructions = quillInstances["recipe-edit-instructions"];

    if (quillIngredients) {
      quillIngredients.setContents(quillIngredients.clipboard.convert(recipe.ingredients || ""));
    } else {
      console.warn("Editor Quill 'recipe-edit-ingredients' não encontrado");
    }

    if (quillInstructions) {
      quillInstructions.setContents(quillInstructions.clipboard.convert(recipe.instructions || ""));
    } else {
      console.warn("Editor Quill 'recipe-edit-instructions' não encontrado");
    }

    new bootstrap.Modal(document.getElementById('editRecipeModal')).show();
  } catch (err) {
    alert('Erro ao carregar receita para edição: ' + err.message);
  }
}
async function submitEdit() {
  const id = document.getElementById('editRecipeId').value;
  const formData = new FormData();

  const quillIngredients = quillInstances["recipe-edit-ingredients"];
  const quillInstructions = quillInstances["recipe-edit-instructions"];

  if (!quillIngredients || !quillInstructions) {
    alert("Um ou mais editores Quill não estão disponíveis.");
    return;
  }

  formData.append('title', document.getElementById('editRecipeTitle').value);
  formData.append('category', document.getElementById('editRecipeCategory').value);
  formData.append('meal_type', document.getElementById('editRecipeMealType').value);
  formData.append('ingredients', quillIngredients.root.innerHTML);
  formData.append('instructions', quillInstructions.root.innerHTML);

  const imageFile = document.getElementById('editRecipeImage').files[0];
  if (imageFile) {
    formData.append('image', imageFile);
  }

  try {
    const res = await fetch(`/recipes/${id}`, {
      method: 'PUT',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Receita atualizada com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('editRecipeModal')).hide();
      await loadRecipes();
    } else {
      alert('Erro ao atualizar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado ao atualizar receita: ' + err.message);
  }
}



            document.getElementById('editRecipeImage').addEventListener('change', function (event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function (e) {
      document.getElementById('editImagePreview').src = e.target.result;
    };
    reader.readAsDataURL(file);
  }
});

            </script>

<script>
   async function submitGlucoseEntry() {
  const form = document.getElementById('glucoseForm');
  const formData = new FormData(form);

  // Pegando conteúdo do Quill corretamente
  const quill = quillInstances["glucose-add-text"];
  if (!quill) {
    alert("Editor de texto não está disponível.");
    return;
  }

  const textHTML = quill.root.innerHTML;
  formData.set('text', textHTML);  // substitui ou adiciona o campo "text"

  const imageInput = document.getElementById('glucoseImage');
  if (imageInput.files.length > 0) {
    formData.set('image', imageInput.files[0]);
  }

  try {
    const res = await fetch('/glucose-walk', {
      method: 'POST',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Glucose Walk salvo com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('addGlucoseModal')).hide();
      form.reset();

      // Limpa o Quill
      quill.setContents([]);

      loadGlucoseEntries();
    } else {
      alert('Erro ao salvar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro de rede: ' + err.message);
  }
}

    
    async function loadGlucoseEntries() {
      try {
        const res = await fetch('/glucose-walk');
        const data = await res.json();
        const tbody = document.getElementById('glucoseEntries');
        tbody.innerHTML = '';
    
        if (!Array.isArray(data)) return;
    
        data.forEach(entry => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td><img style="object-fit:cover;" src="${entry.image_url || '/api/placeholder/60/60'}" width="60" height="60" class="rounded"/></td>
            <td>${entry.title}</td>
            <td>${entry.text}</td>
            <td>${entry.references_text || ''}</td>
            <td>
              <button class="btn btn-sm btn-outline-danger" onclick="deleteGlucoseEntry('${entry.id}')">
                <i class="bi bi-trash"></i>
              </button>

            <button class="btn btn-sm btn-outline-secondary" onclick="editGlucoseEntry('${entry.id}')">
  <i class="bi bi-pencil"></i>
</button>
            </td>


          `;
          tbody.appendChild(tr);
        });
      } catch (err) {
        console.error('Failed to load glucose walk entries:', err);
      }
    }
    
    async function deleteGlucoseEntry(id) {
      if (!confirm('Delete this entry?')) return;
      try {
        const res = await fetch(`/glucose-walk/${id}`, { method: 'DELETE' });
        const result = await res.json();
        if (res.ok) {
          loadGlucoseEntries();
        } else {
          alert('Failed to delete: ' + (result.message || 'Unknown error'));
        }
      } catch (err) {
        alert('Error deleting entry: ' + err.message);
      }
    }
    
    document.addEventListener('DOMContentLoaded', () => {
  // Carrega ao iniciar a página, se já visível
  if (document.querySelector('.tab-pane#glucose-walk').classList.contains('active')) {
    loadGlucoseEntries();
  }

  // Carrega ao ativar a aba
  document.querySelector('[data-bs-target="#glucose-walk"]').addEventListener('shown.bs.tab', () => {
    loadGlucoseEntries();
  });
});

async function editGlucoseEntry(id) {
  try {
    const res = await fetch(`/glucose-walk/${id}`, {
      method: 'GET',
      credentials: 'include'
    });

    if (!res.ok) {
      alert('Erro ao buscar dados para edição');
      return;
    }

    const entry = await res.json();

    document.getElementById('editGlucoseId').value = entry.id;
    document.getElementById('editGlucoseTitle').value = entry.title || '';
    document.getElementById('editGlucoseRefs').value = entry.references_text || '';
    document.getElementById('editGlucosePreview').src = entry.image_url || '/api/placeholder/120/120';

    const quill = quillInstances["glucose-edit-text"];
    if (quill) {
      quill.setContents(quill.clipboard.convert(entry.text || ""));
    } else {
      console.warn("Editor Quill 'glucose-edit-text' não encontrado");
    }

    new bootstrap.Modal(document.getElementById('editGlucoseModal')).show();
  } catch (err) {
    alert('Erro ao carregar entrada: ' + err.message);
  }
}

async function submitGlucoseEdit() {
  const id = document.getElementById('editGlucoseId').value;
  const formData = new FormData();

  const quill = quillInstances["glucose-edit-text"];
  if (!quill) {
    alert("Editor de texto não está disponível.");
    return;
  }

  formData.append('title', document.getElementById('editGlucoseTitle').value);
  formData.append('text', quill.root.innerHTML);
  formData.append('references_text', document.getElementById('editGlucoseRefs').value);

  const imageFile = document.getElementById('editGlucoseImage').files[0];
  if (imageFile) {
    formData.append('image', imageFile);
  }

  try {
    const res = await fetch(`/glucose-walk/${id}`, {
      method: 'PUT',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Entrada atualizada com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('editGlucoseModal')).hide();
      await loadGlucoseEntries();
    } else {
      alert('Erro ao atualizar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}


    </script>
    <script>
        async function loadLightActivationEntries() {
  try {
    const res = await fetch('/light-activation');
    const data = await res.json();

    if (!Array.isArray(data)) {
      console.error('Resposta inválida:', data);
      return;
    }

    const tbody = document.getElementById('lightActivationEntries');
    tbody.innerHTML = '';

    data.forEach(entry => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><img style="objecit-cover;" src="${entry.image_url || '/api/placeholder/60/60'}" class="rounded" width="60" height="60" alt="Image"></td>
        <td>${entry.title}</td>
        <td>${entry.goal || '-'}</td>
        <td>${entry.duration || '-'}</td>
        <td>${entry.best_time || '-'}</td>
        <td>${entry.steps || '-'}</td>
        <td>
          <button class="btn btn-sm btn-outline-secondary" onclick="editLightActivationEntry('${entry.id}')"><i class="bi bi-pencil"></i></button>
          <button class="btn btn-sm btn-outline-danger" onclick="deleteLightActivationEntry('${entry.id}')"><i class="bi bi-trash"></i></button>
        </td>
      `;
      tbody.appendChild(row);
    });
  } catch (err) {
    alert('Network error: ' + err.message);
  }
}
    </script>
    
            <script>
async function submitLightActivationEntry() {
  const form = document.getElementById('lightActivationForm');
  const formData = new FormData(form);

  console.log('[DEBUG] Submitting Light Activation form...');
  console.log('[DEBUG] Form data entries:');
  for (const [key, value] of formData.entries()) {
    console.log(`  - ${key}:`, value);
  }

  try {
    const res = await fetch('/light-activation', {
      method: 'POST',
      body: formData
    });

    console.log('[DEBUG] Response status:', res.status);

    const result = await res.json();
    console.log('[DEBUG] Response body:', result);

    if (res.ok) {
      alert('Light Activation entry saved successfully.');
      bootstrap.Modal.getInstance(document.getElementById('addLightActivationModal')).hide();
      form.reset();
      console.log('[DEBUG] Form reset and modal closed.');
      loadLightActivationEntries(); // Certifique-se que essa função está implementada
    } else {
      console.warn('[WARN] Backend error:', result.message || 'Unknown error');
      alert('Error: ' + (result.message || 'Unknown error'));
    }
  } catch (err) {
    console.error('[ERROR] Network or unexpected failure:', err);
    alert('Network error: ' + err.message);
  }
}


async function editLightActivationEntry(id) {
  try {
    const res = await fetch(`/light-activation/${id}`, { method: 'GET' });

    if (!res.ok) {
      alert('Erro ao buscar dados para edição');
      return;
    }

    const entry = await res.json();

    document.getElementById('editLightId').value = entry.id;
    document.getElementById('editLightTitle').value = entry.title;
    document.getElementById('editLightGoal').value = entry.goal || '';
    document.getElementById('editLightDuration').value = entry.duration || '';
    document.getElementById('editLightBestTime').value = entry.best_time || '';

    // ⚠️ Corrigido para usar Quill
    if (quillInstances['light-edit-steps']) {
      quillInstances['light-edit-steps'].root.innerHTML = entry.steps || '';
    } else {
      console.error("Editor 'light-edit-steps' não inicializado.");
    }

    document.getElementById('editLightPreview').src = entry.image_url || '/api/placeholder/120/120';

    new bootstrap.Modal(document.getElementById('editLightActivationModal')).show();
  } catch (err) {
    alert('Erro ao carregar entrada: ' + err.message);
  }
}



async function deleteLightActivationEntry(id) {
  if (!confirm('Tem certeza que deseja excluir esta entrada?')) return;

  try {
    const res = await fetch(`/light-activation/${id}`, {
      method: 'DELETE'
    });

    const result = await res.json();

    if (res.ok) {
      alert('Entrada excluída com sucesso!');
      await loadLightActivationEntries(); // Recarrega a tabela
    } else {
      alert('Erro ao excluir: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}

async function submitLightActivationEdit() {
  const id = document.getElementById('editLightId').value;
  console.log('[EDIT] ID da entrada:', id);

  const formData = new FormData();

  const title = document.getElementById('editLightTitle').value;
  const goal = document.getElementById('editLightGoal').value;
  const duration = document.getElementById('editLightDuration').value;
  const bestTime = document.getElementById('editLightBestTime').value;

  console.log('[EDIT] Dados coletados:', { title, goal, duration, bestTime });

  formData.append('title', title);
  formData.append('goal', goal);
  formData.append('duration', duration);
  formData.append('best_time', bestTime);

  // Coleta do conteúdo do Quill (steps)
  const quill = quillInstances["light-edit-steps"];
  if (quill) {
    const stepsHTML = quill.root.innerHTML;
    formData.append('steps', stepsHTML);
    console.log('[EDIT] Steps coletado do Quill.');
  } else {
    console.warn("[EDIT] Editor Quill 'light-edit-steps' não encontrado");
  }

  // Imagem
  const imageFile = document.getElementById('editLightImage').files[0];
  if (imageFile) {
    formData.append('image', imageFile);
    console.log('[EDIT] Imagem anexada:', imageFile.name);
  } else {
    console.log('[EDIT] Nenhuma imagem fornecida.');
  }

  try {
    const res = await fetch(`/light-activation/${id}`, {
      method: 'PUT',
      body: formData
    });

    console.log('[EDIT] Status da resposta:', res.status);

    const result = await res.json();
    console.log('[EDIT] Resposta do servidor:', result);

    if (res.ok) {
      alert('Entrada atualizada com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('editLightActivationModal')).hide();
      loadLightActivationEntries(); // Confirme que essa função está ativa
    } else {
      alert('Erro ao atualizar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    console.error('[EDIT] Erro inesperado:', err);
    alert('Erro inesperado ao atualizar: ' + err.message);
  }
}


fetch('/api/home')
  .then(async (res) => {
    if (res.status === 401) {
      window.location.href = '/'; // ou '/login'
      return;
    }
    const data = await res.json();
    // segue uso normal
  })
  .catch(err => console.error('Erro na requisição:', err));
  
</script>
<script>

  



async function deleteLearnMore(id) {
  if (!confirm('Excluir esta entrada?')) return;
  try {
    const res = await fetch(`/learn-more/${id}`, { method: 'DELETE' });
    if (res.ok) {
      await loadLearnMoreEntries();
    } else {
      alert('Erro ao excluir entrada');
    }
  } catch (err) {
    alert('Erro: ' + err.message);
  }
}

async function loadLearnMoreEntries() {
  console.log('[FETCH] Iniciando carregamento de Learn More...');

  try {
    const res = await fetch('/learn-more', {
      method: 'GET',
      credentials: 'include', // 🔥 ENVIA COOKIES de sessão
      headers: {
        'Accept': 'application/json'
      }
    });

    console.log('[FETCH] Status da resposta:', res.status);

    const contentType = res.headers.get('Content-Type') || '';
    if (!contentType.includes('application/json')) {
      const text = await res.text();
      console.error('[ERROR] Resposta não é JSON. Conteúdo:', text);
      throw new Error('Resposta não é JSON');
    }

    const data = await res.json();
    console.log('[FETCH] Dados recebidos:', data);

    const tbody = document.getElementById('learnMoreEntries');
    tbody.innerHTML = '';

    if (!Array.isArray(data)) {
      console.warn('[WARN] Dados retornados não são um array.');
      return;
    }

    data.forEach(entry => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><img src="${entry.image_url || '/api/placeholder/60/60'}" width="60" height="60" class="rounded" /></td>
        <td>${entry.title}</td>
        <td>${entry.description || ''}</td>
        <td>${entry.references_text || ''}</td>
        <td>
          <button class="btn btn-sm btn-outline-secondary" onclick="editLearnMore('${entry.id}')"><i class="bi bi-pencil"></i></button>
          <button class="btn btn-sm btn-outline-danger" onclick="deleteLearnMore('${entry.id}')"><i class="bi bi-trash"></i></button>
        </td>
      `;
      tbody.appendChild(row);
      console.log('[DOM] Linha adicionada:', entry.title);
    });

    console.log(`[SUCCESS] ${data.length} entradas renderizadas.`);

  } catch (err) {
    console.error('[ERROR] Falha ao carregar Learn More:', err);
    alert('Erro ao carregar Learn More: ' + err.message);
  }
}

async function deleteLearnMore(id) {
  if (!confirm('Excluir esta entrada?')) return;
  try {
    const res = await fetch(`/learn-more/${id}`, { method: 'DELETE' });
    if (res.ok) {
      await loadLearnMoreEntries();
    } else {
      alert('Erro ao excluir entrada');
    }
  } catch (err) {
    alert('Erro: ' + err.message);
  }
}

async function submitLearnMore() {
  const formData = new FormData();

  // Title
  formData.append('title', document.getElementById('learnTitle').value);

  // Description from Quill
  const quill = quillInstances['learn-add-description'];
  const htmlDescription = quill ? quill.root.innerHTML : '';
  formData.append('description', htmlDescription);

  // References
  formData.append('references_text', document.getElementById('learnReferences').value);

  // Image
  const imageInput = document.getElementById('learnImage');
  if (imageInput.files.length > 0) {
    formData.append('image', imageInput.files[0]);
  }

  try {
    const res = await fetch('/learn-more', {
      method: 'POST',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Learn More salvo com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('addLearnMoreModal')).hide();
      document.getElementById('learnMoreForm').reset();
      loadLearnMoreEntries();
    } else {
      alert('Erro: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}

async function submitScienceEntry() {
  const formData = new FormData();

  // Title
  formData.append('title', document.getElementById('scienceTitle').value);

  // Description from Quill
  const quill = quillInstances['science-add-description'];
  const htmlDescription = quill ? quill.root.innerHTML : '';
  formData.append('description', htmlDescription);

  // References
  formData.append('references_text', document.getElementById('scienceReferences').value);

  // Image
  const imageInput = document.getElementById('scienceImage');
  if (imageInput.files.length > 0) {
    formData.append('image', imageInput.files[0]);
  }

  try {
    const res = await fetch('/science', {
      method: 'POST',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Science salvo com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('addScienceModal')).hide();
      document.getElementById('scienceForm').reset();
      loadLearnMoreEntries(); // Este pode estar errado — deve ser loadScienceEntries()?
    } else {
      alert('Erro: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}


async function submitScienceEntry() {
  const formData = new FormData();

  formData.append('title', document.getElementById('scienceTitle').value);
  formData.append('description', document.getElementById('scienceDescription').value);
  formData.append('references_text', document.getElementById('scienceReferences').value);

  const imageInput = document.getElementById('scienceImage');
  if (imageInput.files.length > 0) {
    formData.append('image', imageInput.files[0]);
  }

  try {
    const res = await fetch('/science', {
      method: 'POST',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Science salvo com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('addScienceModal')).hide();
      document.getElementById('ScienceForm').reset();
      loadLearnMoreEntries();
    } else {
      alert('Erro: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  // Se já estiver ativa no load
  if (document.querySelector('.tab-pane#learn-more').classList.contains('active')) {
    loadLearnMoreEntries();
  }

  document.querySelectorAll('[data-bs-toggle="tab"]').forEach(tab => {
  tab.addEventListener('shown.bs.tab', (e) => {
    const target = e.target.getAttribute('data-bs-target');
    if (target === '#learn-more') {
      loadLearnMoreEntries();
    }
  });
});
});
document.addEventListener('DOMContentLoaded', () => {
  if (document.querySelector('#learn-more').classList.contains('active')) {
    loadLearnMoreEntries();
  }
});
async function loadScienceEntries() {
  try {
    const res = await fetch('/science');
    const data = await res.json();

    if (!Array.isArray(data)) {
      console.error('Resposta inválida:', data);
      return;
    }

    const tbody = document.getElementById('scienceEntries');
    tbody.innerHTML = '';

    data.forEach(entry => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><img src="${entry.image_url || '/api/placeholder/60/60'}" width="60" height="60" class="rounded" /></td>
        <td>${entry.title}</td>
        <td>${entry.description}</td>
        <td>${entry.references_text || ''}</td>
        <td>
          <button class="btn btn-sm btn-outline-secondary" onclick="editScienceEntry('${entry.id}')"><i class="bi bi-pencil"></i></button>
          <button class="btn btn-sm btn-outline-danger" onclick="deleteScienceEntry('${entry.id}')"><i class="bi bi-trash"></i></button>
        </td>
      `;
      tbody.appendChild(row);
    });
  } catch (err) {
    alert('Erro ao carregar Science: ' + err.message);
  }
}

// EDIT MODAL - Abrir com dados preenchidos
async function editScienceEntry(id) {
  try {
    const res = await fetch(`/science/${id}`);
    const entry = await res.json();

    document.getElementById('scienceTitle').value = entry.title;
    document.getElementById('scienceDescription').value = entry.description;
    document.getElementById('scienceReferences').value = entry.references_text || '';
    document.getElementById('scienceImage').value = '';
    document.getElementById('sciencePreview').src = entry.image_url || '/api/placeholder/120/120';

    document.getElementById('scienceForm').setAttribute('data-edit-id', id);
    new bootstrap.Modal(document.getElementById('addScienceModal')).show();
  } catch (err) {
    alert('Erro ao buscar entrada: ' + err.message);
  }
}

// PUT /science/:id - Atualizar
async function submitScienceEdit() {
  const id = document.getElementById('scienceForm').getAttribute('data-edit-id');
  const formData = new FormData();

  formData.append('title', document.getElementById('scienceTitle').value);
  formData.append('description', document.getElementById('scienceDescription').value);
  formData.append('references_text', document.getElementById('scienceReferences').value);

  const imageInput = document.getElementById('scienceImage');
  if (imageInput.files.length > 0) {
    formData.append('image', imageInput.files[0]);
  }

  try {
    const res = await fetch(`/science/${id}`, {
      method: 'PUT',
      body: formData
    });

    const result = await res.json();
    if (res.ok) {
      alert('Science atualizado com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('addScienceModal')).hide();
      loadScienceEntries();
    } else {
      alert('Erro ao atualizar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}

async function editLearnMore(id) {
  try {
    const res = await fetch(`/learn-more/${id}`);
    if (!res.ok) throw new Error('Falha no fetch');

    const entry = await res.json();

    document.getElementById('editLearnId').value = entry.id;
    document.getElementById('editLearnTitle').value = entry.title || '';
    document.getElementById('editLearnReferences').value = entry.references_text || '';
    document.getElementById('editLearnPreview').src = entry.image_url || '/api/placeholder/120/120';

    const quill = quillInstances["editLearn-description"];
    if (quill) {
      quill.setContents(quill.clipboard.convert(entry.description || ""));
    } else {
      console.warn("Editor Quill 'editLearn-description' não encontrado");
    }

    new bootstrap.Modal(document.getElementById('editLearnMoreModal')).show();
  } catch (err) {
    alert('Erro ao carregar Learn More: ' + err.message);
  }
}



async function submitLearnMoreEdit() {
  const id = document.getElementById('editLearnId').value;
  const formData = new FormData();

  const quill = quillInstances["editLearn-description"];
  if (!quill) {
    alert("Editor de descrição não está disponível.");
    return;
  }

  formData.append('title', document.getElementById('editLearnTitle').value);
  formData.append('description', quill.root.innerHTML);
  formData.append('references_text', document.getElementById('editLearnReferences').value);

  const imageInput = document.getElementById('editLearnImage');
  if (imageInput.files.length > 0) {
    formData.append('image', imageInput.files[0]);
  }

  try {
    const res = await fetch(`/learn-more/${id}`, {
      method: 'PUT',
      body: formData
    });

    const result = await res.json();

    if (res.ok) {
      alert('Learn More atualizado com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('editLearnMoreModal')).hide();
      await loadLearnMoreEntries();
    } else {
      alert('Erro ao atualizar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}


loadScienceEntries()
async function editScienceEntry(id) {
  try {
    const res = await fetch(`/science/${id}`);
    if (!res.ok) throw new Error('Falha no fetch');

    const entry = await res.json();

    document.getElementById('editScienceId').value = entry.id;
    document.getElementById('editScienceTitle').value = entry.title;
     document.getElementById('editScienceReferences').value = entry.references_text || '';
    document.getElementById('editSciencePreview').src = entry.image_url || '/api/placeholder/120/120';
    const quill = quillInstances["editScience-description"];
    if (quill) {
      quill.setContents(quill.clipboard.convert(entry.description || ""));
    } else {
      console.warn("Editor Quill 'editScience-description' não encontrado");
    } 

    new bootstrap.Modal(document.getElementById('editScienceModal')).show();
  } catch (err) {
    alert('Erro ao carregar Science: ' + err.message);
  }
}

async function submitScienceEdit() {
  const id = document.getElementById('editScienceId').value;
  const formData = new FormData();

  // Pegando conteúdo direto dos inputs
  formData.append('title', document.getElementById('editScienceTitle').value);

  // Pegando conteúdo do Quill corretamente
  const quill = quillInstances['editScience-description'];
  const htmlDescription = quill ? quill.root.innerHTML : '';
  formData.append('description', htmlDescription);

  formData.append('references_text', document.getElementById('editScienceReferences').value);

  const image = document.getElementById('editScienceImage').files[0];
  if (image) formData.append('image', image);

  try {
    const res = await fetch(`/science/${id}`, {
      method: 'PUT',
      body: formData
    });
    const result = await res.json();

    if (res.ok) {
      alert('Science atualizado com sucesso!');
      bootstrap.Modal.getInstance(document.getElementById('editScienceModal')).hide();
      loadScienceEntries();
    } else {
      alert('Erro ao atualizar: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}

async function deleteScienceEntry(id) {
  if (!confirm('Tem certeza que deseja excluir esta entrada de Science?')) return;

  try {
    const res = await fetch(`/science/${id}`, {
      method: 'DELETE'
    });

    const result = await res.json();

    if (res.ok) {
      alert('Entrada de Science excluída com sucesso!');
      await loadScienceEntries(); // recarrega a lista
    } else {
      alert('Erro ao excluir: ' + (result.message || 'Erro desconhecido'));
    }
  } catch (err) {
    alert('Erro inesperado: ' + err.message);
  }
}



</script>

<script>
  let quill;

  document.addEventListener("DOMContentLoaded", function () {
    // Inicializa o editor Quill
    quill = new Quill("#quillEditor", {
      theme: "snow",
      placeholder: "Digite os passos aqui com formatação...",
      modules: {
        toolbar: [
          [{ header: [1, 2, false] }],
          ["bold", "italic", "underline"],
          ["blockquote", "code-block"],
          [{ list: "ordered" }, { list: "bullet" }],
          ["clean"]
        ]
      }
    });
  });

  function submitLightActivationEntry() {
    // Pega o HTML gerado pelo Quill
    const stepsHTML = quill.root.innerHTML;

    // Coloca no input hidden
    document.getElementById("lightSteps").value = stepsHTML;

    // Prepara o envio
    const form = document.getElementById("lightActivationForm");
    const formData = new FormData(form);

    fetch('/light-activation', {
      method: 'POST',
      body: formData
    })
    .then(response => response.json())
    .then(result => {
      alert(result.message || 'Light Activation salva com sucesso');
      
      // Opcional: resetar o editor e fechar o modal
      quill.root.innerHTML = '';
      form.reset();
      const modal = bootstrap.Modal.getInstance(document.getElementById('addLightActivationModal'));
      modal.hide();

      // TODO: recarregar tabela/listagem se necessário
    })
    .catch(err => {
      console.error('❌ Erro ao salvar:', err);
      alert('Erro ao salvar');
    });
  }

const quillInstances = {};

document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".quill-editor").forEach(editorEl => {
    const key = editorEl.getAttribute("data-quill");
    quillInstances[key] = new Quill(editorEl, {
      theme: "snow",
      placeholder: "Digite com formatação...",
      modules: {
        toolbar: [
          [{ header: [1, 2, false] }],
          ["bold", "italic", "underline"],
          ["blockquote", "code-block"],
          [{ list: "ordered" }, { list: "bullet" }],
          ["clean"]
        ]
      }
    });
  });
});


function syncQuillEditors() {
  document.querySelectorAll("[data-quill-target]").forEach(input => {
    const key = input.getAttribute("data-quill-target");
    const quill = quillInstances[key];
    if (quill) {
      input.value = quill.root.innerHTML;
    }
  });
}



function submitScienceEntry() {
  syncQuillEditors(); // ← isso é obrigatório ANTES de montar o FormData

  const form = document.getElementById("scienceForm");
  const formData = new FormData(form);

  fetch('/science', {
    method: 'POST',
    body: formData
  })
  .then(res => res.json())
  .then(result => {
    alert(result.message || 'Salvo com sucesso');
    loadScienceEntries()

    // aqui você pode limpar campos, fechar modal, recarregar tabela, etc.
  })
  .catch(err => {
    console.error('Erro ao salvar:', err);
    alert('Erro ao salvar');
  });
}


document.getElementById('addLearnMoreModal').addEventListener('show.bs.modal', () => {
  // Limpa o form
  document.getElementById('learnMoreForm').reset();

  // Limpa o conteúdo do Quill
  const quill = quillInstances['learn-add-description'];
  if (quill) {
    quill.setContents([]);
  }
});
</script>




</body>
</html>